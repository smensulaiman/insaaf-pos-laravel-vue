"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3520],{78596:(t,e,s)=>{s.r(e),s.d(e,{default:()=>i});const i=(0,s(14486).A)({},(function(){return(0,this._self._c)("router-view")}),[],!1,null,null,null).exports},31165:(t,e,s)=>{s.r(e),s.d(e,{default:()=>r});var i=s(5947),a=s.n(i);const n={metaInfo:{title:"Subscriptions"},data:function(){return{isLoading:!0,SubmitProcessing:!1,serverParams:{columnFilters:{},sort:{field:"id",type:"desc"},page:1,perPage:10},totalRows:"",search:"",limit:"10",subscriptions:[]}},computed:{columns:function(){return[{label:this.$t("Customer"),field:"client_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("product_name"),field:"product_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("warehouse"),field:"warehouse_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Billing_Cycle"),field:"billing_cycle",tdClass:"text-left",thClass:"text-left"},{label:this.$t("total_cycles"),field:"total_cycles",tdClass:"text-left",thClass:"text-left"},{label:this.$t("remaining_cycles"),field:"remaining_cycles",tdClass:"text-left",thClass:"text-left"},{label:this.$t("next_billing_date"),field:"next_billing_date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"status",html:!0,tdClass:"text-left",thClass:"text-left",sortable:!1},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}},methods:{isChecked:function(t){var e=this,s=t.status?"active":"canceled";axios.put("/subscriptions/".concat(t.id,"/status"),{status:s}).then((function(t){e.makeToast("success",e.$t("Subscription_status_updated_successfully"),e.$t("Success"))})).catch((function(t){e.makeToast("warning",e.$t("Failed_to_update_subscription_status"),e.$t("Warning"))}))},updateParams:function(t){this.serverParams=Object.assign({},this.serverParams,t)},onPageChange:function(t){var e=t.currentPage;this.serverParams.page!==e&&(this.updateParams({page:e}),this.get_subscriptions(e))},onPerPageChange:function(t){var e=t.currentPerPage;this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.get_subscriptions(1))},onSortChange:function(t){this.updateParams({sort:{type:t[0].type,field:t[0].field}}),this.get_subscriptions(this.serverParams.page)},onSearch:function(t){this.search=t.searchTerm,this.get_subscriptions(this.serverParams.page)},getValidationState:function(t){var e=t.dirty,s=t.validated,i=t.valid;return e||s?void 0===i?null:i:null},makeToast:function(t,e,s){this.$root.$bvToast.toast(e,{title:s,variant:t,solid:!0})},get_subscriptions:function(t){var e=this;a().start(),a().set(.1),axios.get("subscriptions?page="+t+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((function(t){e.subscriptions=t.data.subscriptions,e.totalRows=t.data.totalRows,a().done(),e.isLoading=!1})).catch((function(t){a().done(),setTimeout((function(){e.isLoading=!1}),500)}))},Remove_subscription:function(t){var e=this;this.$swal({title:this.$t("Delete_Title"),text:this.$t("Delete_Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete_cancelButtonText"),confirmButtonText:this.$t("Delete_confirmButtonText")}).then((function(s){s.value&&axios.delete("subscriptions/"+t).then((function(){e.$swal(e.$t("Delete_Deleted"),e.$t("Deleted_in_successfully"),"success"),Fire.$emit("Event_delete_subscription")})).catch((function(){e.$swal(e.$t("Delete_Failed"),e.$t("Delete_Therewassomethingwronge"),"warning")}))}))}},created:function(){var t=this;this.get_subscriptions(1),Fire.$on("Event_delete_subscription",(function(){setTimeout((function(){t.get_subscriptions(t.serverParams.page)}),500)}))}};const r=(0,s(14486).A)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content"},[e("breadcumb",{attrs:{page:t.$t("Subscription_Product"),folder:t.$t("Subscriptions")}}),t._v(" "),t.isLoading?e("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):t._e(),t._v(" "),t.isLoading?t._e():e("b-card",{staticClass:"wrapper"},[e("b-alert",{attrs:{show:"",variant:"info"}},[t._v("\n      ⏱️ "),e("strong",[t._v("Subscription Automation")]),e("br"),e("br"),t._v("\n      Once a subscription is created, the system uses scheduled commands (cron jobs) to handle billing automatically."),e("br"),e("br"),t._v(" "),e("strong",[t._v("1️⃣ Generate Invoices Automatically")]),e("br"),t._v(" "),e("code",[t._v("php artisan subscriptions:generate-invoices")]),e("br"),t._v("\n      This command will automatically create a new sale (invoice) for each active subscription based on its billing cycle (daily, weekly, monthly, yearly)."),e("br"),e("br"),t._v(" "),e("strong",[t._v("2️⃣ Send SMS Reminders")]),e("br"),t._v(" "),e("code",[t._v("php artisan subscriptions:send-sms-reminders")]),e("br"),t._v("\n      This command sends reminder messages to clients for upcoming or due subscription payments via SMS."),e("br"),e("br"),t._v("\n\n      📌 "),e("strong",[t._v("Make sure to schedule these commands in your Cron Job (e.g., cPanel) to run daily or as needed.")])]),t._v(" "),e("vue-good-table",{attrs:{mode:"remote",columns:t.columns,totalRows:t.totalRows,rows:t.subscriptions,"search-options":{enabled:!0,placeholder:t.$t("Search_this_table")},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"table-hover tableOne vgt-table"},on:{"on-page-change":t.onPageChange,"on-per-page-change":t.onPerPageChange,"on-sort-change":t.onSortChange,"on-search":t.onSearch},scopedSlots:t._u([{key:"table-row",fn:function(s){return["actions"==s.column.field?e("span",[e("router-link",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Subscription details",to:"/app/subscription_product/detail/"+s.row.id}},[e("i",{staticClass:"i-Eye text-25 text-primary"})]),t._v(" "),e("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Delete"},on:{click:function(e){return t.Remove_subscription(s.row.id)}}},[e("i",{staticClass:"i-Close-Window text-25 text-danger cursor-pointer"})])],1):"status"==s.column.field?e("div",[e("label",{staticClass:"switch switch-primary mr-3"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.row.status,expression:"props.row.status"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.row.status)?t._i(s.row.status,null)>-1:s.row.status},on:{change:[function(e){var i=s.row.status,a=e.target,n=!!a.checked;if(Array.isArray(i)){var r=t._i(i,null);a.checked?r<0&&t.$set(s.row,"status",i.concat([null])):r>-1&&t.$set(s.row,"status",i.slice(0,r).concat(i.slice(r+1)))}else t.$set(s.row,"status",n)},function(e){return t.isChecked(s.row)}]}}),t._v(" "),e("span",{staticClass:"slider"})])]):t._e()]}}],null,!1,2157896805)},[e("div",{staticClass:"mt-2 mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[e("router-link",{staticClass:"btn-sm btn btn-primary ripple btn-icon m-1",attrs:{to:"/app/subscription_product/store"}},[e("span",{staticClass:"ul-btn__icon"},[e("i",{staticClass:"i-Add"})]),t._v(" "),e("span",{staticClass:"ul-btn__text ml-1"},[t._v(t._s(t.$t("Add")))])])],1)])],1)],1)}),[],!1,null,null,null).exports}}]);